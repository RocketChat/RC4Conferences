"""empty message

Revision ID: 9d21de792967
Revises: 49f3a33f5437
Create Date: 2018-06-05 20:03:20.588368

"""

from alembic import op

# revision identifiers, used by Alembic.
revision = '9d21de792967'
down_revision = '49f3a33f5437'


def upgrade():
    """commands auto generated by Alembic - please adjust!"""
    op.execute(
        """DELETE FROM ticket_holders WHERE id NOT IN
        (SELECT min(id) FROM ticket_holders GROUP BY ticket_id)
        """)
    op.create_unique_constraint('ticket_event', 'ticket_holders', ['ticket_id'])
    # ### end Alembic commands ###


def downgrade():
    """commands auto generated by Alembic - please adjust!"""
    op.drop_constraint('ticket_event', 'ticket_holders', type_='unique')
    # ### end Alembic commands ###
